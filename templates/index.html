<!DOCTYPE HTML>
<html>

<head>
	<title>Flask-SocketIO Test</title>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"
		integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg=="
		crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.0.4/socket.io.js"
		integrity="sha512-aMGMvNYu8Ue4G+fHa359jcPb1u+ytAF+P2SCb+PxrjCdO3n3ZTxJ30zuH39rimUggmTwmh2u7wvQsDTHESnmfQ=="
		crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
	<script type="text/javascript" charset="utf-8">
		$(document).ready(function () {
			// Connect to the Socket.IO server.
			// The connection URL has the following format, relative to the current page:
			//     http[s]://<domain>:<port>[/<namespace>]
			var socket = io();

			// Event handler for server sent data.
			// The callback function is invoked whenever the server emits data
			// to the client. The data is then displayed in the "Received"
			// section of the page.
			socket.on('my_response', function (msg, cb) {
				$('#log').append('<br>' + $('<div/>').text('Received: ' + msg.labels + ' ' + msg.values).html());
				chart.data.datasets[0].data = msg.values;
				chart.update();
				if (cb)
					cb();
			});
		});
	</script>
	<style>
		#myChart {
			max-width: 800px;
			max-height: 400px;
		}
	</style>
</head>

<body>
	<h1>Flask-SocketIO Test</h1>
	<p>
		Async mode is: <b>{{ async_mode }}</b><br>
		Current transport is: <b><span id="transport"></span></b><br>
		Average ping/pong latency: <b><span id="ping-pong"></span>ms</b>
	</p>
	<canvas id="myChart" width="800" height="400"></canvas>
	<h2>Receive:</h2>
	<div id="log"></div>
	<script type="text/javascript" charset="utf-8">
		var ctx = document.getElementById('myChart').getContext('2d');
		var chart = new Chart(ctx, {
			type: 'bar',
			data: {
				labels: ['A', 'B', 'C', 'D', 'E'],
				datasets: [{
					label: 'Value',
					data: [0, 0, 0, 0, 0],
					backgroundColor: [
						'rgba(255, 99, 132, 0.2)',
						'rgba(54, 162, 235, 0.2)',
						'rgba(255, 206, 86, 0.2)',
						'rgba(75, 192, 192, 0.2)',
						'rgba(153, 102, 255, 0.2)'
					],
					borderColor: [
						'rgba(255, 99, 132, 1)',
						'rgba(54, 162, 235, 1)',
						'rgba(255, 206, 86, 1)',
						'rgba(75, 192, 192, 1)',
						'rgba(153, 102, 255, 1)'
					],
					borderWidth: 1
				}]
			},
			options: {
				scales: {
					y: {
						beginAtZero: true
					}
				}
			}
		});
	</script>
</body>

</html>